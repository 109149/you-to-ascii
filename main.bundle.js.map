{"version":3,"sources":["webpack://you-to-ascii/./www/index.module.css?cb62","webpack://you-to-ascii/./www/index.js","webpack://you-to-ascii/./www/utils.module.css?d0fa"],"names":["wrapper","document","createElement","buttonsWrapper","notification","video","canvas","ctx","getContext","pre","togglerButton","copyButton","paused","animationId","chars","className","append","body","style","opacity","autoplay","playsInline","display","width","height","innerText","classList","add","textContent","navigator","mediaDevices","getUserMedia","audio","then","stream","srcObject","catch","err","console","error","onclick","e","play","this","imageData","content","w","h","arr","Array","requestAnimationFrame","render","clearRect","drawImage","getImageData","index","i","data","length","grayScale","convertDataToGrayscale","j","Math","floor","generateASCII","videoToASCII","pause","cancelAnimationFrame","clipboard","writeText","querySelector","setTimeout"],"mappings":"mBACA,QAAwG,wBCKlGA,EAAUC,SAASC,cAAc,OACjCC,EAAiBF,SAASC,cAAc,OACxCE,EAAeH,SAASC,cAAc,OACtCG,EAAQJ,SAASC,cAAc,SAC/BI,EAASL,SAASC,cAAc,UAChCK,EAAMD,EAAOE,WAAW,MACxBC,EAAMR,SAASC,cAAc,OAC7BQ,EAAgBT,SAASC,cAAc,UACvCS,EAAaV,SAASC,cAAc,UAC1C,IAAIU,GAAS,EACTC,EAAc,KAClB,MAAMC,EAAQ,oBAWZd,EAAQe,UD3BgB,0BC4BxBZ,EAAeY,UD5BoD,0BC6BnEf,EAAQgB,OAAOb,GACfF,SAASgB,KAAKD,OAAOhB,GAGrBI,EAAac,MAAMC,QAAU,EAC7Bf,EAAaW,UDlC8J,0BCmC3Kf,EAAQgB,OAAOZ,GAGfC,EAAMe,UAAW,EACjBf,EAAMgB,aAAc,EACpBhB,EAAMa,MAAMI,QAAU,OACtBtB,EAAQgB,OAAOX,GAGfC,EAAOY,MAAMI,QAAU,OACvBhB,EAAOiB,MA1CY,GA2CnBjB,EAAOkB,OA1Ca,GA2CpBxB,EAAQgB,OAAOV,GAGfI,EAAce,UAAY,OAC1Bf,EAAcgB,UAAUC,IAAI,ECnDD,2BDoD3BxB,EAAea,OAAON,GAGtBC,EAAWc,UAAY,OACvBd,EAAWe,UAAUC,IAAI,ECxDsC,2BDyD/DxB,EAAea,OAAOL,GAGtBF,EAAImB,YAAc,GAClBnB,EAAIM,UD7DgI,wBC8DpIf,EAAQgB,OAAOP,GAcfoB,UAAUC,aACPC,aA3De,CAClBC,OAAO,EACP3B,MAAO,CACLkB,MAlBiB,GAmBjBC,OAlBkB,MA0EjBS,MAbL,SAAuBC,GACrB7B,EAAM8B,UAAYD,KAafE,OAVL,SAAqBC,GACnBC,QAAQC,MAAMF,MAmEd3B,EAAc8B,QAAU,SAAUC,GAC5B7B,GACFA,GAAS,EACTP,EAAMqC,OACNC,KAAKlB,UAAY,QAzDvB,SAAsBlB,EAAKE,GACzB,IAIImC,EAJAC,EAAU,GACVC,EAAIvC,EAAID,OAAOiB,MACfwB,EAAIxC,EAAID,OAAOkB,OACfwB,EAAMC,MAAMH,EAAIC,GAOpBlC,EAAcqC,uBAJd,SAASC,IAaP5C,EAAI6C,UAAU,EAAG,EAAGN,EAAGC,GACvBxC,EAAI8C,UAAUhD,EAAO,EAAG,EAAGyC,EAAGC,GAC9BH,EAAYrC,EAAI+C,aAAa,EAAG,EAAGR,EAAGC,GACtCF,EAAU,GACVpC,EAAImB,YAAc,GAcpB,WACE,IAAI2B,GAAS,EACb,IAAK,IAAIC,EAAI,EAAGA,EAAIZ,EAAUa,KAAKC,OAAQF,GAAK,EAAG,CACjD,MAIMG,EAAY,MAJRf,EAAUa,KAAKD,GAIM,MAHrBZ,EAAUa,KAAKD,EAAI,GAGe,KAFlCZ,EAAUa,KAAKD,EAAI,GAI7BR,IAAMO,GAASI,GAhCjBC,GAYF,WACE,IAAK,IAAIJ,EAAI,EAAGA,EAAIT,EAAGS,IAAK,CAC1B,IAAK,IAAIK,EAAIf,EAAI,EAAGe,GAAK,EAAGA,IAAK,CAC/B,IAAIN,EAAQO,KAAKC,OAAQjD,EAAM4C,OAAS,GAAKV,EAAIQ,EAAIT,EAAIc,GAAM,KAC/DhB,GAAW/B,EAAMyC,GAEnBV,GAAW,KAEbpC,EAAImB,YAAciB,EAnBlBmB,GAPAnD,EAAcqC,sBAAsBC,MAkDlCc,CAAa1D,EAAKE,KAElBG,GAAS,EACTP,EAAM6D,QACNvB,KAAKlB,UAAY,OAEjB0C,qBAAqBtD,KAIzBF,EAAW6B,QAAU,SAAUC,GACzBZ,UAAUuC,WACZvC,UAAUuC,UAAUC,UAAUpE,SAASqE,cAAc,OAAO7C,WAC1C,uBASpBrB,EAAac,MAAMC,QAAU,EAC7Bf,EAAaqB,UAVO,uBAWpB8C,YAAW,IAAOnE,EAAac,MAAMC,QAAU,GAAI,OATjDmB,QAAQC,MAAM,uD","file":"main.bundle.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"_2YI3Jv4S8MtPFMjU4uosm7\",\"buttonsWrapper\":\"_38ynaZoDFbersKjrj9RqUx\",\"button\":\"CP3MpFmjjR-ioWbnao1ri\",\"pre\":\"czmxIsC8-ONLxLfEuZ5xQ\",\"notification\":\"_2TVpNziNNpcYMj_FFsBrf8\"};","import \"./global.css\";\nimport styles from \"./index.module.css\";\nimport utilStyles from \"./utils.module.css\";\n\nconst defaultWidth = 50;\nconst defaultHeight = 50;\nconst wrapper = document.createElement(\"div\");\nconst buttonsWrapper = document.createElement(\"div\");\nconst notification = document.createElement(\"div\");\nconst video = document.createElement(\"video\");\nconst canvas = document.createElement(\"canvas\");\nconst ctx = canvas.getContext(\"2d\");\nconst pre = document.createElement(\"pre\");\nconst togglerButton = document.createElement(\"button\");\nconst copyButton = document.createElement(\"button\");\nlet paused = true;\nlet animationId = null;\nconst chars = \"@#80GCLft1i!;:,. \";\n\nconst constraints = {\n  audio: false,\n  video: {\n    width: defaultWidth,\n    height: defaultHeight,\n  },\n};\n\nfunction domSetup() {\n  wrapper.className = styles.wrapper;\n  buttonsWrapper.className = styles.buttonsWrapper;\n  wrapper.append(buttonsWrapper);\n  document.body.append(wrapper);\n\n  /* just a \"notificator\" */\n  notification.style.opacity = 0;\n  notification.className = styles.notification;\n  wrapper.append(notification);\n\n  /* place video */\n  video.autoplay = true;\n  video.playsInline = true;\n  video.style.display = \"none\";\n  wrapper.append(video);\n\n  /* we are capturing video data onto canvas */\n  canvas.style.display = \"none\";\n  canvas.width = defaultWidth;\n  canvas.height = defaultHeight;\n  wrapper.append(canvas);\n\n  /* place button that plays/pauses video */\n  togglerButton.innerText = \"play\";\n  togglerButton.classList.add(styles.button, utilStyles.togglerBkg);\n  buttonsWrapper.append(togglerButton);\n\n  /* copies generated ascii text */\n  copyButton.innerText = \"copy\";\n  copyButton.classList.add(styles.button, utilStyles.copyBkg);\n  buttonsWrapper.append(copyButton);\n\n  /* we are dynamically inserting ascii into pre element */\n  pre.textContent = \"\";\n  pre.className = styles.pre;\n  wrapper.append(pre);\n}\n\nfunction handleSuccess(stream) {\n  video.srcObject = stream;\n}\n\nfunction handleError(err) {\n  console.error(err);\n}\n\nfunction init() {\n  domSetup();\n\n  navigator.mediaDevices\n    .getUserMedia(constraints)\n    .then(handleSuccess)\n    .catch(handleError);\n\n  addListeners();\n}\n\nfunction videoToASCII(ctx, pre) {\n  let content = \"\";\n  let w = ctx.canvas.width;\n  let h = ctx.canvas.height;\n  let arr = Array(w * h);\n  let imageData;\n\n  function render() {\n    animate();\n    animationId = requestAnimationFrame(render);\n  }\n  animationId = requestAnimationFrame(render);\n\n  function animate() {\n    setup();\n    convertDataToGrayscale();\n    generateASCII();\n  }\n\n  function setup() {\n    ctx.clearRect(0, 0, w, h);\n    ctx.drawImage(video, 0, 0, w, h);\n    imageData = ctx.getImageData(0, 0, w, h);\n    content = \"\";\n    pre.textContent = \"\";\n  }\n\n  function generateASCII() {\n    for (let i = 0; i < h; i++) {\n      for (let j = w - 1; j >= 0; j--) {\n        let index = Math.floor(((chars.length - 1) * arr[i * h + j]) / 255);\n        content += chars[index];\n      }\n      content += \"\\n\";\n    }\n    pre.textContent = content;\n  }\n\n  function convertDataToGrayscale() {\n    let index = -1;\n    for (let i = 0; i < imageData.data.length; i += 4) {\n      const r = imageData.data[i];\n      const g = imageData.data[i + 1];\n      const b = imageData.data[i + 2];\n\n      const grayScale = 0.2126 * r + 0.7152 * g + 0.072 * b;\n\n      arr[++index] = grayScale;\n    }\n  }\n}\n\nfunction addListeners() {\n  togglerButton.onclick = function (e) {\n    if (paused) {\n      paused = false;\n      video.play();\n      this.innerText = \"pause\";\n\n      videoToASCII(ctx, pre);\n    } else {\n      paused = true;\n      video.pause();\n      this.innerText = \"play\";\n\n      cancelAnimationFrame(animationId);\n    }\n  };\n\n  copyButton.onclick = function (e) {\n    if (navigator.clipboard) {\n      navigator.clipboard.writeText(document.querySelector(\"pre\").innerText);\n      notify(\"success\", \"Copied to clipboard!\");\n    } else {\n      console.error(\"navigator.clipboard not supported on your browser\");\n    }\n  };\n}\n\nfunction notify(type, text) {\n  if (type === \"success\") {\n    notification.style.opacity = 1;\n    notification.innerText = text;\n    setTimeout(() => (notification.style.opacity = 0), 1300);\n  }\n}\n\ninit();\n","// extracted by mini-css-extract-plugin\nexport default {\"togglerBkg\":\"_2xe6DZQ5_NnURpzIaXE__b\",\"copyBkg\":\"_1YM5NazeM8wzdFKHs7bcLu\"};"],"sourceRoot":""}